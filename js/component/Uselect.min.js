(function(w){function Uselect(){if(this instanceof Uselect){this.config={container:null,skin:null,readOnly:true,maxCount:5,selectHandler:null,dataType:0,data:"",top:15,width:120,liHeight:30};this.isShow=false;this.id=new Date().getTime();}else{return new Uselect();}}
Uselect.prototype=new Widget();AutoComplete.prototype.hide=function(config){config.container&&config.container.hide();}
AutoComplete.prototype.destroy=function(config){config.container&&config.container.empty();}
Uselect.prototype.show=function(config){var CFG=$.extend(this.config,config);if(!CFG.container){consle.log("组件的父容器为空");return;}
this.renderUI(CFG);this.syncUI(CFG);this.bindUI(CFG);return this;};Uselect.prototype.renderUI=function(CFG){var listStr=constrStr(CFG);CFG.container.append(listStr);var selector=CFG.container.find(".u-selector");CFG.container.find("input").css("width",CFG.width);selector.find("li").css({"height":CFG.liHeight,"lineHeight":CFG.liHeight+"px"});""!==CFG.skin&&selector.addClass(CFG.skin);var maxHeight="none";var overflowY="hidden";if(CFG.maxCount){var liList=selector.find("li");var liLen=liList.length;if(liLen>CFG.maxCount){var liHeight=liList.eq(0).height();maxHeight=liHeight*CFG.maxCount;overflowY="scroll";}}
selector.css({"top":CFG.top,"width":CFG.width,"maxHeight":maxHeight,"overflowY":overflowY});}
Uselect.prototype.syncUI=function(CFG){var selector=CFG.container.find(".u-selector");CFG.container.find("input").css("width",CFG.width);selector.find("li").css({"height":CFG.liHeight,"lineHeight":CFG.liHeight+"px"});""!==CFG.skin&&selector.addClass(CFG.skin);var maxHeight="none";var overflowY="hidden";if(CFG.maxCount){var liList=selector.find("li");var liLen=liList.length;if(liLen>CFG.maxCount){var liHeight=liList.eq(0).height();maxHeight=liHeight*CFG.maxCount;overflowY="scroll";}}
selector.css({"top":CFG.top,"width":CFG.width,"maxHeight":maxHeight,"overflowY":overflowY});}
Uselect.prototype.bindUI=function(CFG){var that=this;CFG.container.find(".u-selector li").on("click",function(event){if(CFG.selectHandler){CFG.selectHandler();}
that.fire("select",$(this));CFG.container.find(".u-selector").hide();});CFG.container.blur(function(){console.log("blur");})
$("body").on("click",function(event){var e=event||window.event;var target=e.target||e.srcElement;if(CFG.container[0].contains($(target)[0])){if(!that.isShow){if(CFG.clickHandler){CFG.clickHandler();}
that.fire("click",$(this));CFG.container.find(".u-selector").show();that.isShow=true;return;}
CFG.container.find(".u-selector").hide();that.isShow=false;return;}
if(that.isShow){CFG.container.find(".u-selector").hide();that.isShow=false;}});}
function constrStr(CFG){var data=CFG.data;var listStr='<input type="text" class="u-select"'+(CFG.readOnly?"readonly":"")+' index=""><i class="selector-icon"></i><ul class="u-selector">';if(0===CFG.dataType){listStr+=CFG.data;return listStr+"<ul>";}
if(1===CFG.dataType){var len=data.length;for(var i=0;i<len;i++){listStr+='<li class="u-opt" index="'+data[i].index+'">'+data[i].value+'</li>';}}
return listStr+"<ul>";;}
w.Uselect=Uselect;})(window);