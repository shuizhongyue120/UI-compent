(function(w){function AutoComplete(){if(this instanceof AutoComplete){this.config={obj:null,top:0,left:0,width:0,skin:"",selectHandler:null,changeHandler:null,contentType:0,maxCount:0}}else{return new AutoComplete();}}
AutoComplete.prototype=new window.Widget();AutoComplete.prototype.hide=function(argument){$(".u-autocom-resSelector").hide();}
AutoComplete.prototype.destroy=function(argument){$(".u-autocom-resSelector").remove();}
AutoComplete.prototype.show=function(config){var CFG=$.extend(this.config,config);if(!CFG.obj){return;}
var searchElement=CFG.obj;CFG.width=CFG.width?CFG.width:CFG.obj.width();var that=this;if(window.addEventListener){searchElement[0].oninput=resultHandler;}else{searchElement[0].onpropertychange=resultHandler;}
$("body").on("click",hideResHandler);function hideResHandler(){var $this=$(this);if($this.hasClass("res_li")){return;}
$(".u-autocom-resSelector").hide();}
$("body").on("click",".u-autocom-resSelector li",selectHandler);function selectHandler(event){if(CFG.selectHandler&&"function"===typeof CFG.selectHandler){CFG.selectHandler();that.fire("select","select data");$(".u-autocom-resSelector").hide();return;}
var $this=$(this);var liVal=$this.text();CFG.obj.val(liVal);$(".u-autocom-resSelector").hide();}
function resultHandler(event){var $this=$(this);var val=$this.val();var resStr="";if(0===CFG.contentType){resStr=CFG.changeHandler&&CFG.changeHandler(val);}
if(1===CFG.contentType){var data=CFG.changeHandler&&CFG.changeHandler(val);if("[object Array]"!==Object.prototype.toString.call(data)){return;}
resStr=assembleData(data);}
that.fire("change","change data");appendResult(resStr);}
function appendResult(resStr){if(!resStr||""===resStr){return;}
var selector=$(".u-autocom-resSelector");if(0===selector.length){selectorStr='<div class="u-autocom-resSelector">'+resStr+'</div>';$("body").append(selectorStr);selector=$(".u-autocom-resSelector");}else{selector.empty();selector.append(resStr);}
var maxHeight="none";var overflowY="hidden";if(CFG.maxCount){var liList=selector.find("li");var liLen=liList.length;if(liLen>CFG.maxCount){var liHeight=liList.eq(0).height();maxHeight=liHeight*CFG.maxCount;overflowY="scroll";}}
selector.css({"top":CFG.top,"left":CFG.left,"width":CFG.width,"maxHeight":maxHeight,"overflowY":overflowY});""!==CFG.skin&&selector.addClass(CFG.skin);selector.show();}
function assembleData(data){var len=data.length;var resStr="";for(var i=0;i<len;i++){resStr=resStr+'<li class="res_li" data-value="'+data[i].key+'">'+data[i].value+'</li>'}
return resStr;}
return this;};w.AutoComplete=AutoComplete;})(window);